<h1 class="section-title"><%= trip.trip_name %></h1>
<p class="muted">
  <strong>Dates:</strong>
  <%= trip.start_date ? new Date(trip.start_date).toDateString() : '—' %> →
  <%= trip.end_date ? new Date(trip.end_date).toDateString() : '—' %>
  &nbsp; | &nbsp;
  <strong>Budget:</strong> ₹<%= trip.total_budget || 0 %>
</p>

<!-- DESTINATIONS -->
<section id="destinations" class="mt">
  <h2>Destinations</h2>
  <% if (!destinations.length) { %>
    <div class="alert">No destinations yet. Add one below.</div>
  <% } %>

  <div class="cards">
    <% destinations.forEach(d => { %>
      <article class="card">
        <h3><%= d.city_name %> <span class="muted">(<%= d.country || 'Unknown' %>)</span></h3>
        <p class="muted">
          From: <%= d.start_city || '—' %><br/>
          Arrive: <%= d.arrival_date ? new Date(d.arrival_date).toDateString() : '—' %><br/>
          Depart: <%= d.departure_date ? new Date(d.departure_date).toDateString() : '—' %>
        </p>
        <footer class="card-foot">
          <small class="muted">Destination ID: <%= d.destination_id %></small>
        </footer>
      </article>
    <% }) %>
  </div>

  <form class="card mt" method="post" action="/trip/<%= trip.trip_id %>/add-destination">
    <h3>Add destination</h3>
    <div class="form-grid">
      <input name="start_city" placeholder="Start city (optional)"/>
      <input name="city_name" placeholder="City name" required />
      <input name="country" placeholder="Country" />
      <input name="arrival_date" type="date" />
      <input name="departure_date" type="date" />
    </div>
    <button class="btn">Add</button>
  </form>
</section>

<!-- ACTIVITIES -->
<section id="activities" class="mt">
  <h2>Activities</h2>
  <% if (!activities.length) { %>
    <div class="alert">No activities yet.</div>
  <% } else { %>
    <div class="cards">
      <% activities.forEach(a => { %>
        <article class="card">
          <h3><%= a.activity_name %></h3>
          <p class="muted">
            City: <%= a.city_name %><br/>
            Date: <%= a.activity_date || '—' %> &nbsp; Time: <%= a.start_time || '—' %><br/>
            Cost: ₹<%= a.booking_cost || 0 %>
          </p>
          <% if (a.description) { %><p><%= a.description %></p><% } %>
        </article>
      <% }) %>
    </div>
  <% } %>

  <form class="card mt" method="post" action="/trip/<%= trip.trip_id %>/add-activity">
    <h3>Add activity</h3>
    <div class="form-grid">
      <select name="destination_id" required>
        <option value="" disabled selected>Select destination</option>
        <% destinations.forEach(d => { %>
          <option value="<%= d.destination_id %>"><%= d.city_name %></option>
        <% }) %>
      </select>
      <input name="activity_name" placeholder="Activity name" required />
      <input name="activity_date" type="date" />
      <input name="start_time" type="time" />
      <input name="booking_cost" type="number" step="0.01" placeholder="Cost" />
      <input name="description" placeholder="Notes (optional)" />
    </div>
    <button class="btn">Add</button>
  </form>
</section>

<!-- EXPENSES -->
<section id="expenses" class="mt">
  <h2>Expenses</h2>
  <% if (!expenses.length) { %>
    <div class="alert">No expenses yet.</div>
  <% } else { %>
    <div class="cards">
      <% expenses.forEach(e => { %>
        <article class="card">
          <h3>₹<%= e.amount %> <span class="muted">— <%= e.category_name || 'Uncategorised' %></span></h3>
          <p class="muted">
            <%= e.expense_date || '—' %><br/>
            <%= e.description || '' %>
          </p>
        </article>
      <% }) %>
    </div>
  <% } %>

  <form class="card mt" method="post" action="/trip/<%= trip.trip_id %>/add-expense">
    <h3>Add expense</h3>
    <div class="form-grid">
      <select name="category_id">
        <option value="">Select category (optional)</option>
        <option value="1">Transport</option>
        <option value="2">Hotel</option>
        <option value="3">Food</option>
        <!-- Map your expense_category table as needed -->
      </select>
      <input name="amount" type="number" step="0.01" placeholder="Amount" required />
      <input name="expense_date" type="date" />
      <input name="description" placeholder="Description (optional)" />
    </div>
    <button class="btn">Add</button>
  </form>
</section>
